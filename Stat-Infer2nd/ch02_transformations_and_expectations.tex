\documentclass[12pt]{article}
\usepackage{fullpage}
\usepackage{times}
\usepackage[normalem]{ulem}
\usepackage{fancyhdr,graphicx,amsmath,amssymb, mathtools, scrextend, titlesec, enumitem}\usepackage[pdftex]{hyperref}
\usepackage[ruled,vlined]{algorithm2e} 
\usepackage{parskip}
\include{pythonlisting}

\title{Chapter 2: Transformation and Expectations Exercises}
\begin{document}
\maketitle

\section*{Exercise 2.1}
(1) $y=g(x)=x^3$ and $f_X(x) = 42x^5(1-x), x\in(0,1)$. Note that$\frac{d}{dy}g^{-1} = \frac{1}{3} y^{-\frac{2}{3}}$ is not continuous on $(0,1)$ when it is near 0. We can't use the pmf change of variable theorem. We need to find $F_Y(y)$ first.  
$$ F_X(x) = \int^{x}_{t=0} 42t^5(1-t) dt = 7t^6 - 6t^7 |^{x}_{0} = 7x^6-6x^7$$
Since $g$ is an increasing function, 

$$ F_Y(y) = F_X(g^{-1}(y)) = 7y^2 - 6 y^{\frac{7}{3}}$$

Then pdf for $y$,  $f_y(y) = \frac{d}{dy}F_Y = 14y - 14y^{\frac{4}{3}}$ where $y \in(0,1)$


(2) $g$ is increasing, $f_X = 7e^{-7x}$ is continuous on $[0, \infty)$ and $g^{-1} = (y-3)/4$ has continuous derivative on $[3, \infty)$. Therefore, by theorem 2.1.5, 
$$ f_Y(y) = f_X(g^{-1}(y))\left|\frac{d}{dy}g^{-1}(y)\right| = \frac{7}{4}\exp(-\frac{7}{4}(y-3)), \ \ \ y\in[3,\infty) $$

(3) $g$ doesn't have a continuous inverse. So we will find $F_Y$ instead.
$$ F_X(x) = \int^x_0 30t^2(1-t)^2dt  = 10x^3+6x^5-15x^4$$
Since $g(x) = x^2$ is increasing on $(0,1)$. Therefore
$$ F_Y(y) = F_X(g^{-1}(y)) = 10 y^{3/2} + 6y^{5/2} - 15y^2$$
Pdf $f_Y(y) = \frac{d}{dy} = 15y^{1/2} + 15y^{3/2} - 30y$ for $y\in (0,1)$

\end{document}
