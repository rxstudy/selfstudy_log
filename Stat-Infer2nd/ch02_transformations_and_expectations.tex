\documentclass[12pt]{article}

\include{pythonlisting}
\input{../definitions.tex}

\title{Chapter 2: Transformation and Expectations Exercises}
\begin{document}
\maketitle

\section*{Exercise 2.1}
(1) $y=g(x)=x^3$ and $f_X(x) = 42x^5(1-x), x\in(0,1)$. We will find $F_Y(y)$ instead.  
$$ F_X(x) = \int^{x}_{t=0} 42t^5(1-t) dt = 7t^6 - 6t^7 |^{x}_{0} = 7x^6-6x^7$$
Since $g$ is an increasing function, 

$$ F_Y(y) = F_X(g^{-1}(y)) = 7y^2 - 6 y^{\frac{7}{3}}$$

Then pdf for $y$,  $f_y(y) = \frac{d}{dy}F_Y = 14y - 14y^{\frac{4}{3}}$ where $y \in(0,1)$


(2) $g$ is increasing, $f_X = 7e^{-7x}$ is continuous on $[0, \infty)$ and $g^{-1} = (y-3)/4$ has continuous derivative on $[3, \infty)$. Therefore, by theorem 2.1.5, 
$$ f_Y(y) = f_X(g^{-1}(y))\left|\frac{d}{dy}g^{-1}(y)\right| = \frac{7}{4}\exp(-\frac{7}{4}(y-3)), \ \ \ y\in[3,\infty) $$

(3) We will find $F_Y$ instead.
$$ F_X(x) = \int^x_0 30t^2(1-t)^2dt  = 10x^3+6x^5-15x^4$$
Since $g(x) = x^2$ is increasing on $(0,1)$. Therefore
$$ F_Y(y) = F_X(g^{-1}(y)) = 10 y^{3/2} + 6y^{5/2} - 15y^2$$
Pdf $f_Y(y) = \frac{d}{dy} = 15y^{1/2} + 15y^{3/2} - 30y$ for $y\in (0,1)$

\section*{Exercise 2.2}
(b) $y=g(x)=-\log{x}$ is monotonic, $f_X(x)$ is continuous on $(0,1)$ and $x=g^{-1}(y) = e^{-y}$ has continuous derivative on $(0, \infty)$. Therefore we can use the theorem 2.1.5,
$$ f_Y(y) = f_X(g^{-1}(y))\left|\frac{d}{dy}g^{-1}(y) \right| = \frac{(n+m+1)!}{n!m!}e^{-(n+1)y}(1-e^{-y})^m, \ \ \ y\in (0, \infty)$$

(c) $y=g(x)=e^x$ is monotonic, $f_X(x)$ is continuous on $(0,\infty)$ and $x=g^{-1}(y) = \log{x}$ has continuous derivative of $1/x$ on $(0, \infty)$. Therefore we can use theorem 2.1.5
$$  f_Y(y) = f_X(g^{-1}(y))\left|\frac{d}{dy}g^{-1}(y) \right| = \frac{\log{y}}{y\sigma^2}\exp\left(-\frac{(\log{y})^2}{2\sigma^2}\right)$$

\section*{Exercise 2.3}
$f_Y(y) = P(Y = y) = P(\frac{X}{X+1} = y) = P(X = \frac{y}{1-y}) = \frac{1}{3}\left(\frac{2}{3}\right)^{y/(1-y)}$

\section*{Exercise 2.4}
(a) $\int^{\infty}_{-\infty} f(x)dx =  \int^{\infty}_0 \frac{1}{2}\lambda e^{-\lambda x} dx + \int^0_{-\infty} \frac{1}{2}\lambda e^{\lambda x} dx  = -\frac{1}{2} e^{-\lambda x} |^{\infty}_0 + \frac{1}{2} e^{\lambda x} |_{-\infty}^0 = 1$

(b) 

$$\mbox{For } x < 0,\ \  F_X(t) = \int^t_{-\infty} \frac{1}{2}\lambda e^{\lambda x} dx = \frac{1}{2} e^{\lambda t} $$

$$\mbox{For } x \geq 0, \ \  F_X(t) = F_X(0) + \int^{t}_0 \frac{1}{2}\lambda e^{-\lambda x} dx =1 - \frac{1}{2}e^{-\lambda t})$$


(c) $$P(|X| < t) = P(-|t| < X < |t|) = F_X(|t|) - F_X(-|t|) = 1-  \frac{1}{2}e^{-\lambda |t|}) - \frac{1}{2} e^{- \lambda |t|} =  1 - e^{-\lambda |t|})$$

\section*{Exercise 2.6}
(a) $f_Y(y) = 1/2 \exp(-|y|^{1/3}) |\frac{y^{-2/3}}{3}| = \frac{1}{6} y^{-2/3} \exp(-|y|^{1/3})$
$$\begin{aligned}
\int_{-\infty}^{\infty} f_Y(y)dy &= \int_{0}^{\infty} \frac{1}{6} y^{-2/3} \exp(-y^{1/3}) dy + \int_{-\infty}^{0} \frac{1}{6} y^{-2/3} \exp(y^{1/3}) dy \\
&=  \frac{1}{6} (-3)\exp(-y^{1/3}) |_{0}^{\infty} + \frac{1}{6} (3) \exp(y^{1/3}) |_{-\infty}^{0} \\
&=  \frac{1}{2} + \frac{1}{2} \\
&= 1
\end{aligned}
$$

\section*{Exercise 2.15}
Note that $X \wedge Y \leq X\vee Y$. They can be either $X$ or $Y$ and they are not equal as long as $X\neq Y$. Therefore $X+Y = (X \vee Y) + (X \wedge Y) \rightarrow (X \vee Y) = X+Y - (X \wedge Y)$. Apply expectation to both side. We get $\E(X \vee Y) = \E X + \E Y + \E(X \wedge Y)$

\section*{Exercise 2.23}
(a) Note that $y \in [0, 1)$, $$F_Y(y) = P(Y < y) = P(X^2 < y) = P(-\sqrt{y} < X < \sqrt{y}) = \int^{\sqrt{y}}_{-\sqrt{y}} (1+x)/2 dx = \sqrt{y}$$

Then $$f_Y(y) = \frac{d}{dy}F_Y = \frac{1}{2}\frac{1}{\sqrt{y}}$$

(b) $$EY = \int^{1}_{0} \frac{y}{2}\frac{1}{\sqrt{y}} = \frac{1}{3}$$

$EY^2 = \int^1_0 \frac{y^2}{2} \frac{1}{\sqrt{y}} = \frac{1}{5}$

$$VarY = EY^2 - (EY)^2 = 1/5 - (1/3)^2 = 4/45 $$

\section*{Exercise 2.30}
(a) $M_X(t) = Ee^{tX} = \int_0^c e^{tx} /c dx =  e^{tx}/(tc)|^c_0 = \frac{e^{tc} - 1}{tc}$

(b) $M_X(t) = Ee^{tX} = \int_0^c e^{tx} \frac{2x}{c^2} dx = \frac{2(tce^{tc}-e^tc+1)}{(ct)^2} $

(c) $$\begin{aligned}
M_X(t)= Ee^{tX} &= \int \frac{1}{2\beta} \exp(tx - |x-\alpha|/\beta) dx \\
             &=\frac{1}{2\beta} \int_{-\infty}^{\alpha} \exp(tx + \frac{x}{\beta} - \frac{\alpha}{\beta})
             + \frac{1}{2\beta} \int_{\alpha}^{\infty} \exp(tx - \frac{x}{\beta} + \frac{\alpha}{\beta}) \\
             &=\frac{\exp(- \alpha/\beta)}{2\beta} \frac{1}{t+1/\beta}\exp((t +1/\beta)x) |_{-\infty}^{\alpha} + 
             \frac{\exp(\alpha/\beta)}{2\beta} \frac{1}{t -1/\beta}\exp((t -1/\beta)x) |^{\infty}_{\alpha} \ \ (1) \\
             &= \frac{e^{\alpha t}}{1-(\beta t)^2}
\end{aligned}
$$
Note that in order for the two integral to be finite $t$ must satisfies $-1/\beta \leq t \leq 1/\beta$.

(d) $$M_X(t) = Ee^{tX} = \sum_{x=0}^{\infty} e^{tx} {r+x-1 \choose x} p^r(1-p)^x = \sum_{x=0}^{\infty} {r+x-1 \choose x} p^r(e^{t}(1-p))^x $$

Note that the pmf sums to 1. $$\mbox{i.e.   } \sum_{x=0}^{\infty}{r+x-1 \choose x} p^r(1-p)^x = 1$$ 
We can use this as an identity by adjusting $p$. Replace $p \leftarrow 1 - e^t(1-p)$. Then we have
$$\sum_{x=0}^{\infty}{r+x-1 \choose x}( 1 - e^t(1-p))^r(e^t(1-p))^x = 1$$
Which gives $\sum_{x=0}^{\infty}{r+x-1 \choose x}(e^t(1-p))^x = \frac{1}{( 1 - e^t(1-p))^r}$.
Then $$M_X(t) = \sum_{x=0}^{\infty} {r+x-1 \choose x} p^r(e^{t}(1-p))^x =  \frac{p^r}{( 1 - e^t(1-p))^r}$$
Where $0<1 - e^t(1-p) \leq 1 \Rightarrow t < -\log (1-p)$ 


\end{document}
